var characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",fromCharCode=String.fromCharCode,INVALID_CHARACTER_ERR=function(){"use strict";try{document.createElement("$")}catch(e){return e}}();window.btoa||(window.btoa=function(e){"use strict";for(var t,r,o,n,c,a,i,s=0,h=e.length,l=Math.max,f="";h>s;){if(t=e.charCodeAt(s++)||0,r=e.charCodeAt(s++)||0,i=e.charCodeAt(s++)||0,l(t,r,i)>255)throw INVALID_CHARACTER_ERR;o=t>>2&63,n=(3&t)<<4|r>>4&15,c=(15&r)<<2|i>>6&3,a=63&i,r?i||(a=64):c=a=64,f+=characters.charAt(o)+characters.charAt(n)+characters.charAt(c)+characters.charAt(a)}return f}),window.atob||(window.atob=function(e){"use strict";e=e.replace(new RegExp("=+$"),"");var t,r,o,n,c,a,i,s=0,h=e.length,l=[];if(h%4===1)throw INVALID_CHARACTER_ERR;for(;h>s;)o=characters.indexOf(e.charAt(s++)),n=characters.indexOf(e.charAt(s++)),c=characters.indexOf(e.charAt(s++)),a=characters.indexOf(e.charAt(s++)),t=(63&o)<<2|n>>4&3,r=(15&n)<<4|c>>2&15,i=(3&c)<<6|63&a,l.push(fromCharCode(t)),r&&l.push(fromCharCode(r)),i&&l.push(fromCharCode(i));return l.join("")}),ExcellentExport=function(){"use strict";function e(e,t,r,o){if(window.navigator.msSaveBlob){var c=new Blob([t],r);return window.navigator.msSaveBlob(c,o),!1}if(window.URL.createObjectURL){var a=window.URL.createObjectURL(new Blob([t]),r);e.download=o,e.href=a}else{var i="data:"+r.type+";base64,"+n(t);e.download=o,e.href=i}return!0}var t={excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'},r=",",o="\r\n",n=function(e){var t=encodeURIComponent(e),r=window.unescape(t);return window.btoa(r)},c=function(e,t){return e.replace(new RegExp("{(\\w+)}","g"),function(e,r){return t[r]})},a=function(e){return e.nodeType?e:document.getElementById(e)},i=function(e){var t=e,o=-1!==e.indexOf(r)||-1!==e.indexOf("\r")||-1!==e.indexOf("\n"),n=-1!==e.indexOf('"');return n&&(t=t.replace(/"/g,'""')),(o||n)&&(t='"'+t+'"'),t},s=function(e){var t,n,c,a,s="";for(t=0;t<e.rows.length;t++){for(c=e.rows[t],n=0;n<c.cells.length;n++)a=c.cells[n],s=s+(n?r:"")+i(a.textContent.trim());s+=o}return s},h={excel:function(r,o,n){o=a(o);var i={worksheet:n||"Worksheet",table:o.innerHTML};return e(r,c(t.excel,i),{type:"application/vnd.ms-excel"},"export.xls")},csv:function(t,n,c,i){return void 0!==c&&c&&(r=c),void 0!==i&&i&&(o=i),n=a(n),e(t,s(n),{type:"application/csv"},"export.csv")}};return h}();